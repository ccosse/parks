{% extends 'pacmap_base.html' %}

{% block extra_javascript_include %}
<link rel="stylesheet" type="text/css" href="/static/pacmap/css/pacmap2.css">
<script type="text/javascript" src="/static/pacmap/js/util.js"></script>
<script type="text/javascript" src="/static/pacmap/js/config.js"></script>
<script type="text/javascript" src="/static/pacmap/js/map.js"></script>
<script type="text/javascript" src="/static/pacmap/js/pacmap.js"></script>
<script type="text/javascript" src="/static/pacmap/js/zoom.js"></script>
{% endblock %}

{% block extra_javascript %}

window.notshown=false;
window.orientation='landscape';

window.onresize=function(){
  var AR=window.innerWidth/(window.innerHeight*1.0);
  console.log(window.orientation+" "+AR);

  if(AR<=1. && window.orientation != 'portrait'){
    console.log("portrait");
    window.orientation='portrait';
    $("body").removeClass("landscape");
    $("body").addClass("portrait");
  }
  else if(AR>1. && window.orientation != 'landscape'){
    console.log("landscape");
    window.orientation='landscape';
    $("body").removeClass("portrait");
    $("body").addClass("landscape");
  }

  var bcr=document.getElementById('mapdiv').getBoundingClientRect();
	var res=compute_resolution(Config['bbox'],false,bcr.width,bcr.height);
	window.map.map.setSize([bcr.width,bcr.height]);
	window.map.map.getView().setResolution(res);
}
function init(){

  $("body").addClass("landscape");

  window.map=new Map('mapdiv');
  window.onresize(null);

  $("#controls_toggle-button").click(function(e){

    var val=1;
    if(window.notshown)val*=-1;
    window.notshown=!window.notshown;

  	var bcr=document.getElementById('mapdiv').getBoundingClientRect();
  	var res=compute_resolution(Config['bbox'],false,bcr.width,bcr.height);
    window.map.map.setSize([bcr.width+val*408,bcr.height]);
  	window.map.map.getView().setResolution(res);

    $("#controls_region").toggleClass("notshown");
    $("#mapdiv_region").toggleClass("notshown");


  });
}
{% endblock %}

{% block content %}
<main>
  <div id="controls_region" class="">

    <div class="panel panel-default" style="text-align:center;">
      <table width="100%" ><tr><td>
      <div id="lat" class="panel-body" style="text-align:center;"></div>
      </td><td>
      <div id="lon" class="panel-body" style="text-align:center;"></div>
      </td>
      </tr>
      </table>
    </div>

    <div id="controls_toggle-button" class="">
      <img src="/static/pacmap/img/arrow-lt.png">
    </div>
    <div id="controls" class="">

    </div>
  </div>
  <div id="mapdiv_region" class="">
    <div id="mapdiv" class="">

    </div>
  </div>
</main>
{% endblock %}
